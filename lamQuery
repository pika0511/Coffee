table lam   | eval no = seq()    | sort - no    | parse lamParser    | fields - line    | eval MERGED_PARAM= replace(MERGED_PARAM, "[", ""), MERGED_PARAM= replace(MERGED_PARAM, "]", ""), MERGED_PARAM= replace(MERGED_PARAM, " ", "")    | eval MERGED_PARAM= split(MERGED_PARAM, ",")    | fields MERGED_PARAM  | search  MERGED_PARAM != "null"     |# search MERGED_PARAM == "\\W+"  | explode MERGED_PARAM  | rex field=MERGED_PARAM "(?<MSEC>\S+)@(?<PARAM_NAME>\S+)\=(?<PARAM_VALUE>\S+)" | search MSEC !="---" and PARAM_NAME !="---"  | eval MSEC = int(MSEC)  | eval key=1  | join key  [ table lam | eval no = seq() | sort - no | search line=="*file:*" or line=="*Tool ID:*" or line=="*machineID:*" or line=="*Slot ID:*" or line=="*Lot ID:*" | rex field=line ".*\\data\\(?<MODULE_ID>\S+)\\DataLog.*" | rex field=line ".*Recipe:(?<RECIPE_ID>.*)" | rex field=line ".*Tool ID:(?<EQP_ID>.*)" | rex field=line ".*Lot ID:(?<LOT_ID>.*)" | rex field=line ".*Slot ID:(?<SLOT_ID>.*)" | evtctxadd topic=MODULE_ID key=_table timeout=5m isnotnull(MODULE_ID) | evtctxadd topic=RECIPE_ID key=_table timeout=5m isnotnull(RECIPE_ID) | evtctxadd topic=EQP_ID key=_table timeout=5m isnotnull(EQP_ID) | evtctxadd topic=LOT_ID key=_table timeout=5m isnotnull(LOT_ID) | evtctxadd topic=SLOT_ID key=_table timeout=5m isnotnull(SLOT_ID) | evalc dummy2 = if(isnotnull(MODULE_ID), evtctxsetvar("MODULE_ID", _table, "MODULE_ID", MODULE_ID), null) | evalc dummy2 = if(isnotnull(RECIPE_ID), evtctxsetvar("RECIPE_ID", _table, "RECIPE_ID", RECIPE_ID), null) | evalc dummy2 = if(isnotnull(EQP_ID), evtctxsetvar("EQP_ID", _table, "EQP_ID", EQP_ID), null) | evalc dummy2 = if(isnotnull(LOT_ID), evtctxsetvar("LOT_ID", _table, "LOT_ID", LOT_ID), null) | evalc dummy2 = if(isnotnull(SLOT_ID), evtctxsetvar("SLOT_ID", _table, "SLOT_ID", SLOT_ID), null) | eval MODULE_ID = evtctxgetvar("MODULE_ID", _table, "MODULE_ID") | eval RECIPE_ID = evtctxgetvar("RECIPE_ID", _table, "RECIPE_ID") | eval EQP_ID = evtctxgetvar("EQP_ID", _table, "EQP_ID") | eval LOT_ID = evtctxgetvar("LOT_ID", _table, "LOT_ID") | eval SLOT_ID = evtctxgetvar("SLOT_ID", _table, "SLOT_ID") | fields - line, _time, _table, _id, no | search isnotnull(MODULE_ID) and isnotnull(RECIPE_ID) and isnotnull(EQP_ID) and isnotnull(LOT_ID) and isnotnull(SLOT_ID) | limit 1 | eval key = 1  ]  | fields EQP_ID, MODULE_ID, RECIPE_ID, LOT_ID, SLOT_ID, PARAM_NAME, PARAM_VALUE, MSEC |# search PARAM_NAME == "CurrentStepNumber" |# search PARAM_NAME =="CurrentStepNumber"
